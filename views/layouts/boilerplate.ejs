<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WanderLust</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css" rel="stylesheet" />
    <script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
    <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/6/69/Airbnb_Logo_B%C3%A9lo.svg" type="image/svg+xml">


</head>
<body>
    <%- include("../includes/navbar.ejs") %>


    <div class="container">
      <%- include("../includes/flash.ejs") %>
      <%- body %>
    </div>
    
    <%- include("../includes/footer.ejs") %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <script src="/js/script.js"></script>
   

    <!-- for rating Star -->
  <script>
  const stars = document.querySelectorAll('#star-rating i');
  const ratingInput = document.getElementById('rating');

  stars.forEach((star, index) => {
    star.addEventListener('click', () => {
      const value = index + 1;
      ratingInput.value = value;

      // Highlight stars
      stars.forEach((s, i) => {
        if (i < value) {
          s.classList.add('fa-solid');
          s.classList.remove('fa-regular');
        } else {
          s.classList.add('fa-regular');
          s.classList.remove('fa-solid');
        }
      });
    });
  });
</script>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const stars = document.querySelectorAll("#rating-stars .rating-star");
    const ratingValue = document.getElementById("rating-value");

    stars.forEach((star) => {
        star.addEventListener("click", () => {
            let val = Number(star.getAttribute("data-value")); // <- convert to number

            ratingValue.value = val; // <- store number

            stars.forEach((s, i) => {
                if (i < val) s.classList.add("active");
                else s.classList.remove("active");
                s.classList.remove("clicked");
            });

            star.classList.add("clicked");
        });
    });
});


</script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const searchBtn = document.getElementById("searchBtn");
  const searchInput = document.getElementById("searchInput");
  const suggestions = document.getElementById("suggestions");

  // When clicking search button -> expand input
  searchBtn.addEventListener("click", () => {
    searchInput.classList.toggle("active");
    searchInput.focus();
  });

  // Fetch suggestions from DB
  searchInput.addEventListener("input", async () => {
    const q = searchInput.value;
    if (!q) {
      suggestions.style.display = "none";
      return;
    }

    const response = await fetch(`/listings/search?q=${q}`);
    const data = await response.json();

    suggestions.innerHTML = "";

    if (data.length === 0) {
      suggestions.style.display = "none";
      return;
    }

    data.forEach(item => {
      const li = document.createElement("li");
      li.textContent = item.title;

      li.onclick = () => {
        window.location.href = `/listings/${item._id}`;
      };

      suggestions.appendChild(li);
    });

    suggestions.style.display = "block";
  });

});
</script>

</body>
</html>